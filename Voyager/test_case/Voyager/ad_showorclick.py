#encoding:utf-8
import MySQLdb as mysql,time,datetime



def mydb1():
    db = mysql.connect(host='123.59.17.121',user='voyager',passwd='SIkxiJI5r48JIvPh',db='voyagerlog',port=3306,charset='utf8')
    db.autocommit(True)
    c = db.cursor()
    sql=tmpsql()
    adorderclick=[]
    adzoneclick=[]
    countclick=[]
    for i in sql:
        c.execute(i)
        result=c.fetchall()
        for i in result:
            adorderclick.append(str(i[0]))
            adzoneclick.append(str(i[1]))
            countclick.append(str(i[2]))
    print adorderclick
    print adzoneclick
    print countclick
    return countclick
def tmpsql():
    adzone_id=[3663,3867,3517,3659,3757,3706,3691,3549,3477,3786,3815,3760,3549,3760,3815,3884,3788,3624,3619,3788,3536,3831,3778,3536,2661,3885,3536,3788,2038,3705,3537,3263,3835,3815,3537,3663,3391,3832,3880,3251,2549,3880,3640,3536,1889,3539,3637,3201,3664,3835,1693,3815,3619,3787,3742,3872,3898,2847,3742,2549,3742,3549,3201,3619,3835,3867,3545,3702,3246,3664,3808,3550,3742,3202,3815,1729,3019,3757,3202,3687,3537,3880,3742,3263,3815,3742,3776,3815,3508,3839,1263,3831,3901,3661,3550,3485,3637,3537,3703,3660,3832,3187,3648,3687,3115,3867,3160,3637,3321,3635,1754,3635,3787,3705,3788,3815,3187,3832,3637,3537,3865,3765,3815,3536,3382,3742,3635,1729,3536,3675,3638,3619,3862,3640,3484,3392,3321,3831,1262,3831,3537,3549,3619]
    ad_order_id=[152,152,152,152,152,152,152,353,152,192,355,152,356,226,192,178,355,152,253,178,178,355,152,355,192,152,353,353,152,355,59,178,192,178,264,226,178,355,178,152,152,355,355,162,355,355,178,355,353,355,152,162,192,192,355,152,355,152,57,178,353,355,353,343,253,192,192,178,152,355,355,355,178,355,356,355,226,226,178,192,178,192,356,355,57,162,192,353,192,192,355,353,178,152,178,355,355,355,178,152,162,355,162,178,355,178,355,162,178,178,152,355,57,178,192,165,178,353,183,165,152,192,266,57,178,192,162,178,356,192,192,165,355,353,355,355,162,356,355,178,356,266,183]
    tmysql=[]
    for i in range(len(adzone_id)):
        # print '11'+str(adzone_id[i])+'11'+str(ad_order_id[i])
        t='SELECT ad_order_id,adzone_id,COUNT(*) from voyagerlog.ad_click_log20171019 where ad_order_id ='+str(ad_order_id[i])+'and adzone_id='+str(adzone_id[i])+' GROUP BY ad_order_id HAVING COUNT(*)<100'
        tmysql.append(t)
    return tmysql

if __name__ == '__main__':
    # t=tmpsql()
    print tmpsql()
    # print mydb1()



